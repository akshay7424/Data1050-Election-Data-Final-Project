<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../css/styles.css" />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/nvd3/1.7.0/nv.d3.min.css"
      rel="stylesheet"
    />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/nvd3/1.7.0/nv.d3.min.js"></script>
  </head>
  <body>
    <nav id="navBar" class="navBar withNavBarOneEdgeShadow">
      <div class="navBarOverallContainer">
        <a class="navBarSiteLogo tabHighlightable" href="/" tabindex="0">
          <span class="insideTabHighlightable insideButText" tabindex="-1">
            Startup Analysis
          </span>
        </a>

        <div class="navbar_routes">
          <ul class="nav navbar-nav mx-auto">
            <a class="btn btn-light navbar-btn" href="./data">Data</a>
            <a class="btn btn-light navbar-btn" href="./creds">Creds</a>
          </ul>
        </div>
      </div>
    </nav>
    <br /><br /><br />

    <h1>U.S. Map of Startups</h1>

    <nav class="navbar navbar-expand-md navbar-inverse">
      <div class="container-fluid">
        <ul class="nav navbar-nav mx-auto">
          <a
            style="text-decoration: none"
            class="btn btn-light navbar-btn"
            href="./data25"
            >&lt;</a
          >
          <a
            style="text-decoration: none"
            class="btn btn-light navbar-btn"
            href="./data3"
            >&gt;</a
          >
        </ul>
      </div>
    </nav>

    <div id="About" class="tabcontent">
      <h3>Top 10 U.S. States by Activity Index</h3>
      <p>
        The following are comprehensive indicators of new business creation in
        the United States, capturing business activity in all industries, and
        based on both a nationally representative sample size of more than a
        half-million observations each year and on the universe of all employer
        businesses in the United States.
      </p>

      <p class="description">
        Nationally, the Startup Activity Index rose for the third year in a row,
        rebounding from its lowest point in almost twenty years.5 Most states
        followed a similar positive trajectory, with thirty states experiencing
        an increase in startup activity. Six states saw little to no changes
        compared to the previous year, and fourteen saw their startup activity
        levels fall in the past year.
      </p>
    </div>

    <!-- Load d3.js and the geo projection plugin -->
    <script src="https://d3js.org/d3.v4.js"></script>
    <script src="https://d3js.org/d3-geo-projection.v2.min.js"></script>
    <h4>Toggle checkbox below to filter by Activity Index:</h4>
    <div>
      <input type="checkbox" class="checkbox" value="A" checked /><label
        >Rate of New Entrepreneurs</label
      >
      <input type="checkbox" class="checkbox" value="B" unchecked /><label
        >Opportunity Share of New Entrepreneurs</label
      >
      <input type="checkbox" class="checkbox" value="C" unchecked /><label
        >Startup Density</label
      >
    </div>

    <!-- Create an element where the map will take place -->
    <div>
      <svg id="my_dataviz" width="500" height="400"></svg>
    </div>
    <div>
      <h3>Index components:</h3>

      <li>
        <b> Rate of New Entrepreneurs: </b> The percentage of adults
        transitioning into entrepreneurship at a given point in time.
      </li>
      <li>
        <b> Opportunity Share of New Entrepreneurs: </b>The percentage of new
        entrepreneurs driven primarily by 'opportunity' vs. 'necessity'.
      </li>
      <li>
        <b> Startup Density: </b> The number of new employer businesses,
        normalized by population.
      </li>
    </div>
    <script>
      // The svg
      var svg = d3.select("svg"),
        width = +svg.attr("width"),
        height = +svg.attr("height");

      // Map and projection
      var projection = d3
        .geoMercator()
        .center([-99, 37]) // GPS of location to zoom on
        .scale(400) // This is like the zoom
        .translate([width / 2, height / 2]);

      // Create data for circles:
      var markers = [
        //Rate of entrepreneurs
        { long: -119.417931, lat: 36.778259, group: "A", size: 42 * 0.7 }, // california
        { long: -100.0, lat: 31.0, group: "A", size: 40 * 0.7 }, // texas
        { long: -81.760254, lat: 27.994402, group: "A", size: 38 * 0.7 }, // florida
        { long: -111.093735, lat: 34.048927, group: "A", size: 40 * 0.5 }, // arizona
        { long: -105.358887, lat: 39.113014, group: "A", size: 35 * 0.5 }, // colorado
        { long: -74.948051, lat: 42.165726, group: "A", size: 36 * 0.3 }, // new york
        { long: -74.521011, lat: 40.298904, group: "A", size: 34 * 0.3 }, // new jersey
        { long: -83.643074, lat: 33.040619, group: "A", size: 33 * 0.2 }, // georgia
        { long: -79.806419, lat: 35.630066, group: "A", size: 34 * 0.2 }, // north carolina
        { long: -92.288368, lat: 38.456085, group: "A", size: 30 * 0.2 }, // missouri

        // Opportunity share of new entrepreneurs
        { long: -86.692345, lat: 35.747845, group: "B", size: 88.66 * 0.7 }, // tenessee
        { long: -74.521011, lat: 40.298904, group: "B", size: 88.03 * 0.7 }, // new jersey
        { long: -105.358887, lat: 39.113014, group: "B", size: 87.18 * 0.7 }, // colorado
        { long: -82.764915, lat: 40.388783, group: "B", size: 88.22 * 0.5 }, // ohio
        { long: -100.0, lat: 31.0, group: "B", size: 84.59 * 0.5 }, // texas
        { long: -74.948051, lat: 42.165726, group: "B", size: 84.1 * 0.3 }, // new york
        { long: -83.643074, lat: 33.040619, group: "B", size: 86.6 * 0.3 }, // georgia
        { long: -84.536095, lat: 43.326618, group: "B", size: 84.19 * 0.2 }, // michigan
        { long: -71.530106, lat: 42.230171, group: "B", size: 85.4 * 0.2 }, // massachussetts
        { long: -121.490494, lat: 47.400902, group: "B", size: 87.39 * 0.2 }, // washington

        // Startup Density
        { long: -81.760254, lat: 27.994402, group: "C", size: 98.7 * 0.7 }, // florida
        { long: -100.0, lat: 31.0, group: "C", size: 90.9 * 0.7 }, // texas
        { long: -92.288368, lat: 38.456085, group: "C", size: 95.5 * 0.7 }, // missouri
        { long: -119.417931, lat: 36.778259, group: "C", size: 89.6 * 0.5 }, // california
        { long: -105.358887, lat: 39.113014, group: "C", size: 88.2 * 0.5 }, // colorado
        { long: -111.093735, lat: 34.048927, group: "C", size: 85.8 * 0.3 }, // arizona
        { long: -74.948051, lat: 42.165726, group: "C", size: 83.3 * 0.3 }, // new york
        { long: -83.643074, lat: 33.040619, group: "C", size: 86.6 * 0.1 }, // georgia
        { long: -121.490494, lat: 47.400902, group: "C", size: 81.5 * 0.1 }, // washington
        { long: -74.521011, lat: 40.298904, group: "C", size: 88.03 * 0.1 }, // new jersey
      ];

      // Load external data and boot
      d3.json(
        "https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson",
        function (data) {
          // Filter data
          //data.features = data.features.filter(function (d) {
          //  return d.properties.name == "France";
          //});

          // Create a color scale
          var color = d3
            .scaleOrdinal()
            .domain(["A", "B", "C"])
            .range(["#402D54", "#D18975", "#8FD175"]);

          // Add a scale for bubble size
          var size = d3
            .scaleLinear()
            .domain([1, 100]) // What's in the data
            .range([4, 50]); // Size in pixel

          // Draw the map
          svg
            .append("g")
            .selectAll("path")
            .data(data.features)
            .enter()
            .append("path")
            .attr("fill", "#b8b8b8")
            .attr("d", d3.geoPath().projection(projection))
            .style("stroke", "black")
            .style("opacity", 0.3);

          // Add circles:
          svg
            .selectAll("myCircles")
            .data(markers)
            .enter()
            .append("circle")
            .attr("class", function (d) {
              return d.group;
            })
            .attr("cx", function (d) {
              return projection([d.long, d.lat])[0];
            })
            .attr("cy", function (d) {
              return projection([d.long, d.lat])[1];
            })
            .attr("r", function (d) {
              return size(d.size);
            })
            .style("fill", function (d) {
              return color(d.group);
            })
            .attr("stroke", function (d) {
              return color(d.group);
            })
            .attr("stroke-width", 3)
            .attr("fill-opacity", 0.4);

          // This function is gonna change the opacity and size of selected and unselected circles
          function update() {
            // For each check box:
            d3.selectAll(".checkbox").each(function (d) {
              cb = d3.select(this);
              grp = cb.property("value");

              // If the box is check, I show the group
              if (cb.property("checked")) {
                svg
                  .selectAll("." + grp)
                  .transition()
                  .duration(1000)
                  .style("opacity", 1)
                  .attr("r", function (d) {
                    return size(d.size);
                  });

                // Otherwise I hide it
              } else {
                svg
                  .selectAll("." + grp)
                  .transition()
                  .duration(1000)
                  .style("opacity", 0)
                  .attr("r", 0);
              }
            });
          }

          // When a button change, I run the update function
          d3.selectAll(".checkbox").on("change", update);

          // And I initialize it at the beginning
          update();
        }
      );
    </script>

    <br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
    <button onclick="topFunction()" id="myBtn" title="Go to top">Top</button>
    <script>
      mybutton = document.getElementById("myBtn");

      // When the user scrolls down 20px from the top of the document, show the button
      window.onscroll = function () {
        scrollFunction();
      };

      function scrollFunction() {
        if (
          document.body.scrollTop > 20 ||
          document.documentElement.scrollTop > 20
        ) {
          mybutton.style.display = "block";
        } else {
          mybutton.style.display = "none";
        }
      }

      // When the user clicks on the button, scroll to the top of the document
      function topFunction() {
        document.body.scrollTop = 0; // For Safari
        document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
      }
    </script>

    <!-- footer -->
    <div class="footer">
      <p><b>Created by Harry Tasha Akshay </b> @DATA1050</p>
    </div>
  </body>
</html>
